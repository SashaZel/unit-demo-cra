name: Tag release

on: 
    push:
        tags:
            - '*'

jobs:
  create_issue:
    runs-on: ubuntu-latest
    defaults:
      run:
        working-directory: .
    permissions:
      issues: write
    # steps:
    #   - name: Create issue using REST API
    #     run: |
    #       curl --request POST \
    #       --url https://api.github.com/repos/${{ github.repository }}/issues \
    #       --header 'authorization: Bearer ${{ secrets.GITHUB_TOKEN }}' \
    #       --header 'content-type: application/json' \
    #       --data '{
    #         "title": "Automated issue for commit: ${{ github.sha }}",
    #         "body": "This issue was automatically created by the GitHub Action workflow **${{ github.workflow }}**. \n\n The commit hash was: _${{ github.sha }}_."
    #         }' \
    #       --fail
    steps:
      - name: Checkout
        uses: actions/checkout@v3
        with:
          fetch-depth: 0
      - name: Setup node
        uses: actions/setup-node@v3
        with:
          node-version: '18.x'
      - name: Instal Oktokit SDK
        run: npm install @octokit/core
      - name: run ci file
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: node ./ci/createIssue.js